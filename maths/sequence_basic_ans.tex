\documentclass[a4paper]{ltjsarticle}

\input{./src/packages.tex}
\input{./src/styles.tex}
\input{./src/macros.tex}

\title{
  {\Large 数列と漸化式} \\
  --- 基本編 解答 ---
}
\author{
  Yuta Suzuki
  \thanks{https://github.com/suzuyut4}
}
\date{}

\newcommand{\flan}[1]{\begin{fleqn}[20pt]\begin{align*} #1 \end{align*}\end{fleqn}}

%**************************************************************
\begin{document}

\maketitle

\section{数列と漸化式の基本}

\subsection{漸化式}

そもそも、公式を用いて簡単に解ける漸化式は次の3つに限られます。

\begin{enumerate}[label=(\roman*)]
  \item
  $a_{n+1} = a_n + d$  \rightarrow\, 公差$d$の等差数列
  \begin{fleqn}[20pt]
    \begin{align}
      \Rightarrow a_n = a_1 + (n-1)d \label{eq:tousa}
    \end{align}
  \end{fleqn}
  \item
  $a_{n+1} = ra_n$     \rightarrow\, 公比$r$の等比数列
  \begin{fleqn}[20pt]
    \begin{align}
      \Rightarrow a_n = a_1 r^{n-1} \label{eq:touhi}
    \end{align}
  \end{fleqn}
  \item
  $a_{n+1} = a_n + b_n$\rightarrow\, 階差数列が$\{b_n\}$の数列$\{a_n\}$
  \begin{fleqn}[20pt]
    \begin{align}
      \Rightarrow n\geqq 2 \text{のとき、}\:a_n = a_1 + \sum_{k=1}^{n-1}b_k \label{eq:kaisa}
    \end{align}
  \end{fleqn}
\end{enumerate}
以下、\eqref{eq:tousa}の形を等差型、\eqref{eq:touhi}の形を等比型、\eqref{eq:kaisa}の形を階差型
と呼ぶことにします。
この形以外のほぼすべての漸化式はなんとかしてこの形に帰着させることが目的で、
多くの場合は等比数列の形に変形してから一般項を求めるということも覚えておくとよいです。

せっかくなので\eqref{eq:kaisa}の形だけはここで証明しておきましょう。
\begin{prf*}
$a_{n+1} = a_n + b_n \Leftrightarrow a_{n+1} - a_n = b_n$であるので、
$n\geqq 2$のとき$n$を$n-1,n-2,\cdots,2,1$として足し合わせると
{\newcommand{\dl}[1]{\raisebox{-2pt}{$#1$}}
\begin{fleqn}[20pt]
  \begin{align*}
    &\begin{matrix}
      & a_n     & - & a_{n-1} & = & b_{n-1} \\
      & a_{n-1} & - & a_{n-2} & = & b_{n-2} \\
      & a_{n-2} & - & a_{n-3} & = & b_{n-3} \\
      &       & \vdots &    &\vdots &       \\
      & a_3     & - & a_2     & = & b_2     \\
  +) & a_2     & - & a_1     & = & b_1     \\
  \hline
      & \dl{a_n}     & \dl{-} & \dl{a_1}     & \dl{=} & \dl{b_{n-1} + b_{n-2} + \cdots + b_2 + b_1}
    \end{matrix}
    \\
    &\Leftrightarrow a_n = a_1 + \sum_{k=1}^{n-1}b_k \qquad \qed
  \end{align*}
\end{fleqn}
}
\end{prf*}

ここで、証明一行目において$n-1$以下のケースを考えることによってこの式を得ています。
しかし、この変形ができるのは$n-1\geqq 1$すなわち$n\geqq 2$のときのみです。
そのため、階差型においては条件$n\geqq 2$を忘れてはいけません。
すなわち、一般項を求めたとき、$n=1$でもその式が成り立っているか必ず確認し、
成り立っていればそのように書き、成り立っていなければ場合分けして一般項を示す必要があります。
解答の書き方など詳しくは、\ref*{sec:basic_of_recurrenceformula}漸化式 基本編で確認してください。


\subsection{数列の和$S_n$}
一般項$a_n$で表される数列について第一項から第$n$項までの和を$S_n$で表すことがあります。
すなわち
\begin{fleqn}[20pt]
  \begin{align*}
    S_n = \sum_{k=1}^{n}a_k
  \end{align*}
\end{fleqn}
です。以下、特に断りがなければ$S_n$を数列$\{a_n\}$に対する和を表すものとします。

\newpage
\section{数列とその周辺}
\begin{question*}
次の値を$n$を用いて表せ。
\begin{ans*}
${}$
\begin{enumerate}[label=\arabic*.]
  \item
    \flan{
        \sum_{k=1}^{n}k
        &= \frac{1}{2}n(n+1)
    }
  \item
    \flan{
        \sum_{k=1}^{n}k^2
        &= \frac{1}{6}n (n+1)(2n+1)
    }
  \item
    \flan{
        \sum_{k=1}^{n}k^3
        &= \left\{ \frac{1}{2}n(n+1) \right\}^2
    }
  \begin{supple*}
  $\disp \sum_{k=1}^{n}k^m$の公式については次のように求められていることを思い出しておきましょう。

  $(k+1)^m$の展開公式から得る次の恒等式
  \flan{
      (k+1)^m - k^m = \sum_{i=0}^{m-1}{}_{m}\rm{C}_{i}k^i
  }
  を用いる。たとえば$m=4$ならば
  \flan{
      (k+1)^4 - k^4 = 1 + 4k + 6k^2 + 4k^3
  }
  この両辺に$k=1$から$n$までの和をとって
  \flan{
      &\sum_{k=1}^{n} \{(k+1)^4 - k^4 \} \\
      &= 2^4 - 1^4 + 3^4 - 2^4 + \cdots + n^4 - (n-1)^4 + (n+1)^4 - n^4 \\
      &= (n+1)^4 - 1 \\
      &=\sum_{k=1}^{n}(1 + 4k + 6k^2 + 4k^3)
  }
  すなわち
  \flan{
      (n+1)^4 - 1 = \sum_{k=1}^{n}(1 + 4k + 6k^2 + 4k^3)
  }
  であり、これを\dm{\sum_{k=1}^{n}k^3}を左辺に、その他を右辺に移項して整理すると
  $m=1,2$の$\disp \sum_{k=1}^{n}k^m$がわかっていれば
  左辺を$n$についての式として得られるということになる。
  これを繰り返せば$m=4$以上でも同様に公式を得ることができる。
\end{supple*}
といった感じです。
  \item
    \flan{
        \sum_{k=1}^{n}\cfrac{3}{k(k+2)}
        &= \frac{3}{2}\sum_{k=1}^{n}\left( \frac{1}{k} - \frac{1}{k+2} \right) \\
        \begin{split}
          &= \frac{3}{2} \left\{
            \left(1-\frac{1}{3}\right) + \left(\frac{1}{2}-\frac{1}{4}\right)
            + \left(\frac{1}{3}-\frac{1}{5}\right)
            + \cdots \right. \\
          & \left.\hspace*{50pt}
            + \left(\frac{1}{n-1}-\frac{1}{n+1}\right)
            + \left(\frac{1}{n}-\frac{n}{n+2}\right)
            \right\}
        \end{split} \\
        &= \frac{3}{2}\left(1+\frac{1}{2}-\frac{1}{n+1}-\frac{1}{n+2}\right) \\
        &= \frac{9}{4} - \frac{3(2n+3)}{2(n+1)(n+2)}
      }
  \item
    \flan{
        \sum_{k=1}^{n}\cfrac{3}{\sqrt{k+2} + \sqrt{k}}
        &= 3 \sum_{k=1}^{n}\frac{\sqrt{k+2}-\sqrt{k}}{(\sqrt{k+2}+\sqrt{k})(\sqrt{k+2}-\sqrt{k})} \\
        &= 3 \sum_{k=1}^{n}\frac{\sqrt{k+2}-\sqrt{k}}{2} \\
        \begin{split}
          &= \frac{3}{2}\bigl\{
            \bigl(\sqrt{3}-\sqrt{1}\bigr)
            + \bigl(\sqrt{4}-\sqrt{2}\bigr)
            + \cdots \bigr. \\
          &\bigl.\hspace*{50pt}
              + \bigl(\sqrt{n+1}-\sqrt{n-1}\bigr)
              + \bigl(\sqrt{n+2}-\sqrt{n}\bigr)
            \Bigr\} \\
        \end{split} \\
        &= \frac{3}{2}\left( \sqrt{n+2} + \sqrt{n+1} - 1 - \sqrt{2} \right)
      }
  \item
    \flan{
        S_n = \sum_{k=1}^{n}\{(2k-1)\cdot 2^{k-1}\}
      }
    とおく。
{\newcommand{\dl}[1]{\raisebox{-2pt}{$#1$}}
    このとき
      \flan{
          &\begin{matrix}
            & S_n  & = & 1\cdot1             & + \hspace*{2pt} 3\cdot2 \hspace*{2pt} + \hspace*{2pt} 5\cdot2^2 &+& \cdots &+& (2n-1)\cdot2^{n-1} &                  \\
         -) & 2S_n & = & \hphantom{1\cdot 1} & + \hspace*{2pt} 1\cdot2 \hspace*{2pt} + \hspace*{2pt} 3\cdot2^2 &+& \cdots &+& (2n-3)\cdot2^{n-1} & \hspace*{-6pt}+ \,(2n-1)\cdot2^n \\
         \hline
            & \dl{-S_n} &\dl{=}& \dl{1\cdot1}   & \dl{+ \hspace*{2pt} 2\cdot2 \hspace*{2pt} + \hspace*{2pt} 2\cdot2^2} &\dl{+}& \dl{\cdots} &\dl{+}& \dl{2\cdot2^{n-1}} & \hspace*{-6pt}\dl{-\,(2n-1)\cdot2^n} \\
           \end{matrix} \\
           &\Leftrightarrow -S_n = 1 + 2^2 + 2^3 + \cdots + 2^{n-1} + 2^n - (2n-1)\cdot2^n \\
           &\Leftrightarrow -S_n = 1 + \frac{4(2^{n-1}-1)}{2-1} - (2n-1)\cdot2^n \\
           &\Leftrightarrow -S_n = 1 + 2^{n+1} - 4 - (2n-1)\cdot2^n \\
           &\Leftrightarrow  S_n = (2n-1-2)\cdot2^n + 3 \\
           &\therefore S_n = (2n-3)\cdot2^n + 3
        }
}

  \item
          \flan{
              &\frac{1}{1} + \frac{1}{1+2} + \frac{1}{1+2+3} + \cdots + \frac{1}{1+2+3+\cdots +(n-1)+n} \\
              &= \sum_{k=1}^{n}\frac{1}{\cfrac{1}{2}k(k+1)} \\
              &= \sum_{k=1}^{n}2\Bigl(\frac{1}{n} - \frac{1}{n+1}\Bigr) \\
              &= 2\tm\Bigl(\frac{1}{1} - \frac{1}{2} + \frac{1}{2} - \cdots + \frac{1}{n} - \frac{1}{1+n}\Bigr) \\
              &= \frac{2n}{n+1}
            }
  \item \dm{S_n = 1+\frac{2}{3}+\frac{3}{3^2}+\cdots+\frac{n}{3^{n-1}}}とおくと、\dm{\frac{S_n}{3}}との差を考えて
          \flan{
              &1+\frac{2}{3}+\frac{3}{3^2}+\cdots+\frac{n}{3^{n-1}} \\
              &= \cdots = \frac{9}{4} - \frac{2n+3}{4\cdot 3^{n-1}}
            }
\end{enumerate}
\end{ans*}
\end{question*}


\newpage
\section{漸化式 基本編}\label{sec:basic_of_recurrenceformula}

漸化式の問題はしばしば誘導がされます。
そのため、何も誘導がなければ好きな方法で解けばいいですが、
誘導があったりするとそれに乗らなくてはならないということです。
それぞれのパターンの漸化式に対して別解がある場合は抑えておき、
様々な問題に対応できるようにしておきましょう。

\begin{question*}
次の式を満たす数列$\{a_n\}$の一般項を$n$を用いて表せ。
\begin{ans*}
${}$
\begin{enumerate}[label=\arabic*.]
  \item $a_1 = 2,\; a_{n+1} = a_n + 3 $\tousa
  \flan{
    a_n
    &= 2 + (n-1) \times 3 \\
    &= 3n - 1
  }
  \item $a_1 = 5,\; a_{n+1} = 7a_n$ \touhi
  \flan{
    a_n
    &= 5\cdot 7^{n-1}
  }
  \item $a_1 = 3,\; a_{n+1} = 3a_n -4$ \tokusyukai \\
  特性方程式$\gra = 3\gra -4 \Leftrightarrow \gra = 2$より
  $a_{n+1} - 2 = 3(a_n - 2)$ \touhi と変形できるので
  \flan{
    &a_n - 2 \\
    &= (a_1 - 2) \times 3^{n-1} \\
    &= 3^{n-1}
  }
  よって、
  \flan{
    a_n = 3^{n-1} + 2
  }
  \begin{supple*}
    慣れない間は$b_n = a_n - 2$とおく習慣をつけるといいです。
  \end{supple*}

  \item $a_1 = 1,\; a_{n+1} = a_n + 2n$ \kaisa \\
  $n\geqq 2$のとき
  \flan{
    a_n
    &= 1 + 2\sum_{k=1}^{n-1} k \\
    &= n^2 - n + 1
  }
  これは$n = 1$のときも成り立つ。
  \item $a_1 = 1,\; a_{n+1} = a_n + 3^n - 4n$\kaisa \\
  $n\geqq 2$のとき
  \flan{
    a_n
    &= 1 + \sum_{k=1}^{n-1} (3^k-4k) \\
    &= 1 + \frac{3^{n} -3}{3-1} - \frac{1}{2} (n-1) n \\
    &= \frac{1}{2}\cdot 3^{n} - 2n^2 + 2n - \frac{1}{2}
  }
  これは$n = 1$のときも成り立つ。
  \item $a_1 = 1,\; a_2 = 2,\; a_{n+2} = a_{n+1} + 6a_n$ \sankoukan \\
  特性方程式$\gra^2 = \gra + 6 \Leftrightarrow \gra = -2,3$より、
  \flan{
    &\begin{dcases*}
      a_{n+2} + 2a_{n+1} = 3(a_{n+1} + 2a_n)  \:\: \touhi \\
      a_{n+2} - 3a_{n+1} = -2(a_{n+1} - 3a_n) \:\: \touhi
    \end{dcases*}\\
    &\Rightarrow
    \begin{dcases*}
      a_{n+1} + 2a_n = 4\cdot 3^{n-1}\\
      a_{n+1} - 3a_n = -(-2)^{n-1}
    \end{dcases*}
  }
  この2式より、
  \flan{
    a_n = \frac{4\cdot 3^{n-1} + (-2)^{n-1}}{5}
  }
  \begin{other*}
    特性方程式より
    \flan{
      a_{n+2} + 2a_{n+1} = 3(a_{n+1} + 2a_n)
    }
    よって、
    \flan{
      &\begin{aligned}
        a_{n+1} + 2a_n
        &= (a_2 + 2a_1)\cdot 3^{n-1} \\
        &= 4\cdot3^{n-1} \\
      \end{aligned} \\
      &\Leftrightarrow a_{n+1} = -2a_n + 4\cdot3^{n-1}
    }
    $3^{n+1}\neq 0$より、
    \flan{
      \frac{a_{n+1}}{3^{n+1}} = -\frac{2}{3}\frac{a_n}{3^n} + \frac{4}{9} \:\:\touhi
    }
    すなわち、
    \flan{
      & \frac{a_{n+1}}{3^{n+1}} - \frac{4}{15} = -\frac{2}{3}\left(\frac{a_n}{3^n} - \frac{4}{15} \right) \\
      & \frac{a_n}{3^n} - \frac{4}{15} = \frac{1}{15} \cdot \left( -\frac{2}{3} \right)^{n-1} \\
      & a_n
      = \left( \frac{4}{15} + \frac{1}{15} \cdot \left( -\frac{2}{3} \right)^{n-1} \right) \cdot 3^n
      = \frac{4\cdot3^{n-1} + (-2)^{n-1}}{5}
    }
  \end{other*}


  \item  $a_1 = 2,\; a_{n+1} = 16a_n^5$ \jisuusoui \\
  与えられた漸化式より$a_n> 0$より、両辺に底を2として対数をとると、
  \flan{
    \log_2 a_{n+1} = 5\log_2 a_n + 4
  }
  ここで、$b_n = \log_2 a_n$とおくと$b_1 = 1$であるので
  \flan{
    &b_{n+1} = 5b_n + 4\\
    &b_{n+1} + 1 = 5(b_n + 1) \:\: \touhi \\
    &b_n = 2\cdot 5^{n-1} -1
  }
  よって、
  \flan{
    a_n = 2^{2\cdot 5^{n-1} -1}
  }
  \item $a_1 = 1,\; a_{n+1} = 2a_n + n^2 -6$ \\
  この漸化式が、$a_{n+1} + p(n+1)^2 + q(n+1) + r = 2(a_n + pn^2 + qn + r)$と
  表せるとすると、これを展開した$a_{n+1} = 2a_n + pn^2 + (-2p + q)n + (-p-q+r)$と
  与えられた漸化式の係数は常に等しいので（恒等式）
  \flan{
    &\begin{dcases*}
        p = 1\\
      -2p +q =0 \\
      - p -q +r =-6
    \end{dcases*}
    \\
    &\therefore (p,q,r) = (1\;,\;2\;,\;-3)
  }
  ゆえに
  \flan{
    &a_{n+1} + (n+1)^2 + 2(n+1) - 3
            = 2( a_n + n^2 + 2n - 3 ) \\
    & a_n + n^2 + 2n - 3 = (a_1 + 1 + 2 - 3 )\cdot 2^{n-1} = \cdot 2^{n-1} \\
    & \therefore a_n = 2^{n-1} - n^2 - 2n + 3
  }

  \vskip.3\baselineskip
  この問題は上のような解法が最もよいと思われるが、次の誘導がされる場合があります。
  \begin{practice*}
    $b_n = a_{n+1} - a_n$ とおいたときの$b_n$の漸化式を導き、さらに
    $c_n = b_{n+1} - b_n$とおいたときの$c_n$を求めることで$a_n$の一般項を求めよ。 \\
    \begin{ans*}
      与えられた漸化式より$a_{n+2} = 2a_{n+1} + (n+1)^2 - 6$であるので、与式とこの式の差をとって
      \flan{
        &a_{n+2} - a_{n+1} = 2(a_{n+1} - a_n) + 2n +1 \\
        & b_{n+1} = 2b_n + 2n + 1 \:\: (b_1 = -4,\: b_2 = -5)
      }
      さらに、$b_{n+2} = 2b_{n+1} + 2(n+1) + 1$であるので、上式とこの式の差をとって
      \flan{
        &b_{n+2} - b_{n+1} = 2(b_{n+1} - b_n) + 2 \\
        &c_{n+1} = 2c_n + 2 \:\: (c_1 = -1) \\
        & \Leftrightarrow c_{n+1} + 2 = 2(c_n + 2) \:\: \touhi
      }
      すなわち、
      \flan{
        &c_n = 2^{n-1} - 2
      }
      また、$c_n$は$b_n$の階差数列より、
      \flan{
        &b_n = b_1 + \sum_{k=1}^{n-1}c_k \:\:(n\geqq 2) \\
        &\Rightarrow b_n = 2^{n-1} - 2n - 3 \:\:(\text{これは$n=1$でも成り立つ})
      }
      $a_n$についても、階差数列$b_n$が上のように得られるので、
      \flan{
        &a_n = a_1 + \sum_{k=1}^{n-1}b_k \:\:(n\geqq 2) \\
        &\therefore a_n = 2^{n+1} - n^2 - 2n + 3 \:\:(\text{これは$n=1$でも成り立つ})
      }
    \end{ans*}
  \end{practice*}

  \item $a_1 = 1,\; a_{n+1} = 4a_n + n\cdot 2^n$ \sisu \\
  両辺を$2^{n+1}$でわると
  \flan{
    \frac{a_{n+1}}{2^{n+1}} = 2 \frac{a_n}{2^n} + \frac{n}{2}
  }
  これが$\disp\frac{a_{n+1}}{2^{n+1}} + p(n+1) + q = 2 \biggl( \frac{a_n}{2^n} + pn + q \biggr) $
  と表せるとすると、これを展開した\\
  $\disp \frac{a_{n+1}}{2^{n+1}}=2\frac{a_n}{2^n} + pn + (-p + q)$
  と与えられた漸化式の係数は常に等しいので
  \flan{
    (p,q) = \left(\frac{1}{2}\;,\;\frac{1}{2}\right)
  }
  すなわち
  \flan{
    \frac{a_{n+1}}{2^{n+1}} + \frac{1}{2}(n+1) + \frac{1}{2}
    = 2 \left( \frac{a_n}{2^n} + \frac{1}{2}n + \frac{1}{2} \right) \:\: \touhi
  }
  ゆえに
  \flan{
    &\frac{a_n}{2^n}+\frac{1}{2}n+\frac{1}{2} = \frac{3}{2}2^{n-1} \\
    &a_n =2^n \left( 3\cdot 2^{n-2} - \frac{n}{2} - \frac{1}{2} \right) \\
    &\therefore a_n = 3\cdot 2^{2n-2} - (n+1)2^{n-1}
  }

  \item $a_1 = 1,\; a_2=3,\; a_{n+2} = 4a_{n+1} - 4a_n$\sankoukanjuukai \\
  特性方程式$\gra^2 = 4\gra - 4 \Leftrightarrow \gra = 2$より
  \flan{
    a_{n+2} - 2a_{n+1} = 2(a_{n+1} - 2a_n) \:\: \touhi
  }
  よって、
  \flan{
    a_{n+1} - 2a_n = 2^{n-1}
  }
  $-2a_n$を移項し、両辺を$2^{n+1}$でわると
  \flan{
    &\frac{a_{n+1}}{2^{n+1}} = \frac{a_n}{2^n} + \frac{1}{4} \:\: \tousa \\
    &\frac{a_n}{2^n} = \frac{1}{2} + \frac{1}{4}(n-1) = \frac{1}{4}(n+1) \\
    & \therefore a_n = (n+1)2^{n-2}
  }

  \item $a_1 = 1,\; a_2 = 4,\; a_{n+2} = 4a_{n+1} - 3a_n - 2$ \sankoukanteisuukou \\
  特性方程式$\gra^2 = 4\gra -3 \Leftrightarrow \gra = 1,3$より
  \flan{
    &\begin{dcases*}
      a_{n+2} - a_{n+1} = 3(a_{n+1} - a_n) - 2  \\
      a_{n+2} - 3a_{n+1} = (a_{n+1} - 3a_n) - 2
    \end{dcases*}
  }
  また、$b_n = a_{n+1} - a_n,\:c_n = a_{n+1} - 3a_n$とおくと$b_1 = 3,\:c_1 = 1$であり
  \flan{
    &\begin{dcases*}
      b_{n+1} = 3b_n - 2 \\
      c_{n+1} = c_n -2
    \end{dcases*}
    \\
    &\Leftrightarrow
    \begin{dcases*}
      b_{n+1} - 1 = 3(b_n - 1) \:\: \touhi \\
      c_{n+1} = c_n - 2  \:\: \tousa
    \end{dcases*}
    \\
    &\Leftrightarrow
    \begin{dcases*}
      b_n = a_{n+1} - a_n = 2\cdot 3^{n-1} + 1 \\
      c_n = a_{n+1} - 3a_n = -2n + 3
    \end{dcases*}
  }
  この2式から$\disp a_n = \frac{b_n - c_n}{2}$であるので一般項は
  \flan{
    a_n
    = \frac{2\cdot 3^{n-1} + 2n - 2}{2}
    = 3^{n-1} + n - 1
  }

  \item $\disp a_1 = 1,\: a_{n+1} = \frac{a_n}{2a_n + 3}$ \bunsugyakusutikan \\
  ある$k\in \mathbb{N}$に対して$a_k = 0$であると仮定すると
  \flan{
    0 = a_k = \frac{a_{k-1}}{2a_{k-1} + 3} \Leftrightarrow a_{k-1} = 0
  }
  であり、これを繰り返すことで$0 = a_{k-1} = a_{k-2} = \cdots = a_1$となるが、これは$a_1 = 1$に矛盾。\\
  よって、任意の自然数$n$で$a_n \neq 0$であるので、$\disp b_n = \frac{1}{a_n}$とおくと、$b_1 = 1$で
  \flan{
    &\begin{aligned}
      b_{n+1}
      &= \frac{1}{a_{n+1}} \\
      &= \frac{2a_n + 3}{a_n} \\
      &= \frac{3}{a_n} + 2 \\
      &= 3b_n + 2 \\
    \end{aligned} \\
    &\Leftrightarrow b_{n+1} + 1 = 3(b_n + 1)
  }
  すなわち、
  \flan{
    &b_n = 2\cdot 3^{n-1} - 1 \\
    & \Rightarrow a_n = \frac{1}{2\cdot 3^{n-1} - 1}
  }

  \item $\disp a_1 = 3,\; a_{n+1} = \frac{3a_n-4}{a_n-2}$ \bunsutokusei \\
  特性方程式$\disp \gra =\frac{3\gra - 4}{\gra - 2} \Leftrightarrow \gra = 1,4$より \\
  ここで、ある$k\in \mathbb{N}$に対して、$a_k = 1$であると仮定すると
  \flan{
    a_k = 1 = \frac{3a_{k-1} - 4}{a_{k-1} - 2} \Leftrightarrow a_{k-1} = 1
  }
  であり、これを繰り返すことで$1 = a_k = a_{k-1} = \cdots = a_1$となるが、これは$a_1 = 3$に矛盾。\\
  よって、任意の自然数$n$で$a_n \neq 1$であるので、
  $\disp b_n = \frac{a_n - 4}{a_n - 1}$とおくと$\disp b_1 = -\frac{1}{2}$で
  \flan{
    b_{n+1}
    &= \frac{3a_{n+1} - 4}{a_{n+1} - 1}
    = \cfrac{\cfrac{3a_n-4}{a_n-2}-4}{\cfrac{3a_n-4}{a_n-2}-1} \\
    &= -\frac{1}{2}b_n \:\: \touhi
  }
  よって、$\disp b_n = \biggl(-\frac{1}{2}\biggr)^n$であり、$b_n \neq 1$ \\
  また、
  \flan{
    b_{n} = \frac{a_n - 4}{a_n - 1} \Rightarrow a_n = \frac{b_n - 4}{b_n - 1} \:\:(\because b_n \neq 1)
  }
  であるので、
  \flan{
    a_n
    = \frac{\biggl(-\cfrac{1}{2}\biggr)^n - 4}{\biggl(-\cfrac{1}{2}\biggr)^n - 1}
    = \frac{2^{n+2} - (-1)^n}{2^n - (-1)^n}
  }

  \item $\disp a_1 = 3,\; a_{n+1} = \frac{3a_n-4}{a_n-1}$ \bunsujuukai \\
  特性方程式$\disp \gra =\frac{3\gra - 4}{\gra - 1} \Leftrightarrow \gra = 2$より \\
  ここで、ある$k\in \mathbb{N}$に対して、$a_k = 2$であると仮定すると、
  \flan{
    a_k = 2 = \frac{3a_{k-1} - 4}{a_{k-1} - 1} \Leftrightarrow a_{k-1} = 2
  }
  であり、これを繰り返すことで$2 = a_k = a_{k-1} = \cdots = a_1$となるが、これは$a_1 = 3$に矛盾。\\
  よって、任意の自然数$n$で$a_n \neq 2$であるので、$\disp b_n = \frac{1}{a_n - 2}$とおくと$b_1 = 1$で
  \flan{
    b_{n+1}
    &= \frac{1}{a_{n+1} - 2}
      = \frac{1}{\cfrac{3a_n - 4}{a_n - 1} - 2} \\
    &= \frac{a_n - 1}{a_n - 2} \\
    &= b_n + 1 \:\: \tousa  \\
    &\Rightarrow b_n = 1 + (n - 1) \cdot 1 = n
  }
  また、任意の自然数$n$で$b_n \neq 0 \not\equiv 0$から
  \flan{
    b_n = \frac{1}{a_n - 2} \Rightarrow a_n = \frac{1}{b_n} + 2
  }
  であるので
  \flan{
    a_n = \frac{1}{n} + 2 \left( = \frac{2n + 1}{n} \right)
  }

  \begin{supple*}
    分数型の漸化式の解き方について簡単におさらいしましょう。\\
    $\disp a_{n+1} = \frac{pa_n + q}{ra_n + s}$について特性方程式$\disp\gra = \frac{p\gra + q}{r\gra + s}$
    を考え、その2解を$\grl_1,\grl_2$とおいたときに
    \flan{
      b_n = \frac{a_n - \grl_1}{a_n - \grl_2}
    }
    あるいは
    \flan{
      b_n = \frac{1}{a_n - \grl}
    }
    とおくことで漸化式を解くことができました。 \\
    さて、分数型での$q=0$である場合に$a_n$の逆数を置き換えたのは
    特性方程式の解のうちいずれか一つは必ず$0$であるからです。
    \flan{
      \gra = \frac{p\gra}{r\gra + s} \Leftrightarrow \gra = 0,\,\frac{p-s}{r}
    }
    要するに、上の置き換えにおける$\grl = 0$の場合であると思えばよいということです。
    逆に、逆数置換をするということはあくまで特性方程式の解の一つを用いて
    $\grl = 0$としたということに過ぎないわけですから
    $\disp\grl = \frac{p-s}{r}$のようにもう一つの解を置いても問題なく解くことはできます。
    加えて、$\disp b_n = \frac{1}{a_n - \grl}$とおくパターンは特性方程式が重解の場合も
    解けるということですから、重解でない場合にも同じようにこの置換で解くことができます。

    いずれの場合についても実際に自分で手を動かして解いてみてください。
  \end{supple*}

  \item $a_1 = 1,\; a_{n+1}=(n+1)a_n$ \kaihi \\
  両辺を$(n+1)!\neq 0$でわると
  \flan{
    \frac{a_{n+1}}{(n+1)!} = \frac{a_n}{n!} \:\: \touhi
  }
  よって
  \flan{
    &\frac{a_n}{n!} = \frac{a_1}{1!} = 1 \\
    &\therefore a_n = n!
  }
  \item $a_1 = 1,\; (n+2)a_{n+1}=na_n$ \kaihi \\
  両辺を$n+1$倍すると
  \flan{
    (n+2)(n+1)a_{n+1} = (n+1)n\;a_n \:\: \touhi
  }
  よって
  \flan{
    &(n+1)na_n = (1+1)\cdot 1 a_1 = 2 \\
    &\therefore a_n = \frac{2}{n(n+1)}
  }
  \item $a_1 = 1,\; na_{n+1}=2(n+1)a_n+n(n+1)$ \kaihitousa \\
  両辺を$n(n+1)\neq 0$でわると
  \flan{
    &\frac{a_{n+1}}{n+1} = 2\frac{a_n}{n} + 1 \\
    &\frac{a_{n+1}}{n+1} + 1 = 2\left( \frac{a_n}{n} + 1 \right) \:\: \touhi
  }
  よって
  \flan{
    &\frac{a_n}{n} + 1 = 2\cdot 2^{n-1} =2^n \\
    &\therefore a_n = n (2^n-1)
  }
  \item $\disp a_1 = 2,\; a_{n+1} = \frac{n+2}{n}a_n + 1$ \\
  両辺を$(n+1)(n+2)\neq 0$でわると
  \flan{
    \frac{a_{n+1}}{(n+1)(n+2)} = \frac{a_n}{n(n+1)}
  }
  より$\disp b_n = \frac{a_n}{n(n+1)}$とおくと$b_1=1$であり、
  \flan{
    b_{n+1}
    &= b_n + \frac{1}{(n+1)(n+2)} \:\: \kaisa
  }
  である。よって$n\geqq 2$のとき
  \flan{
    b_n
    &= b_1 + \sum_{k=1}^{n-1}\frac{1}{(k+1)(k+2)} \\
    &= 1 + \sum_{k=1}^{n-1}\left( \frac{1}{k+1}-\frac{1}{k+2} \right) \\
    &= 1 + \frac{1}{2} - \frac{1}{n+1} \\
    &= \frac{3n+1}{2(n+1)}
  }
  また、$n=1$のとき\dm{b_1 = \frac{3\cdot1 + 1}{2(1+1)} = 1}より、$n=1$のときもこれは成り立つ。
  以上より、
  \flan{
    a_n
    &= n(n+1)b_n \\
    &= \frac{n(3n+1)}{2}
  }

  \item $a_1 = 1,\; a_{n+1} = 2^{2n-2}(a_n)^2$ \\
  以下、数列$a_n$が任意の自然数$n$に対して$a_n>0$であることを示す。
  \begin{enumerate}[label=(\roman*)]
    \item $n=1$のとき$a_1=1>0$
    \item $n=k \:(k\in \mathbb{N})$のとき、$a_n>0$と仮定すると$a_k>0\quad \cdots (1)$\\
    また、
    \flan{
      a_{k+1} = 2^{2k-2}(a_k)^2 > 0
    }
    より$n=k+1$のときも成り立つ。
  \end{enumerate}
  (i),\, (ii)より数学的帰納法からすべての自然数$n$で$a_n>0$である。\\
  漸化式の両辺に底を2とする対数をとると、
  \flan{
    \log_2a_{n+1} = (2n-2)+2\log_2a_n
  }
  である。$b_n = \log_2a_n$とおくと、$b_1=0$であり$b_{n+1} = 2b_n + 2n - 2$となるが\\
  これが$b_{n+1} + p(n+1) + q = 2(b_n + pn + q)$と表せるとすると、\\
  これを展開した$b_{n+1} = 2b_n + pn + (-p+q)$と係数が等しいので
  \flan{
    &
    \begin{dcases*}
      p=2 \\
      q-p=-2
    \end{dcases*}
    \\
    &\Rightarrow
    \begin{dcases*}
      p = 2 \\
      q = 0
    \end{dcases*}
  }
  より
  $b_{n+1} + 2(n+1) = 2(b_n + 2n) \:\: \touhi$であるので、
  \flan{
    & b_n + 2n = (b_1 + 2) \cdot 2^{n-1} = 2^n \\
    & \Rightarrow b_n = 2^n - 2n \\
    & \Rightarrow a_n = 2^{2^{n}-2n}
  }

  \item $S_n = 3a_n + 2n - 1$ \\
  $S_{n+1} = 3a_{n+1} + 2n + 1$および$S_{n+1}=S_n + a_{n+1}$より
  \flan{
    &S_{n+1} - S_n = a_{n+1} =  3a_{n+1} - 3a_n + 2 \\
    &\Rightarrow a_{n+1} = \frac{3}{2}a_n - 1 \\
    &a_{n+1} - 2 = \frac{3}{2}(a_n - 2) \\
    &\therefore a_n = \frac{5}{2}\cdot\biggl(\frac{3}{2}\biggr)^{n-1}+2
  }

\end{enumerate}\end{ans*}\end{question*}

\end{document}
